# ECE 255, Current Sources, Mirrors etc

28 November 2017

In this lecture, we will follow Section 8.2 of Sedra and Smith. It will be on IC biasing, current sources, current mirrors, and current-steering circuits. In this method, a reference current is generated by a circuit, and then replicated at other circuits by current mirror or current steering.

### 1 The Basic MOSFET Current Source

Here is the image describtion:
```
The image depicts an electronic circuit diagram featuring two MOSFET transistors, labeled Q1 and Q2. Here is a detailed description of the components and their connections:

1. **Power Supply (V_DD)**: The circuit is powered by a voltage source labeled V_DD, which is connected to the top of the circuit.

2. **Resistor (R)**: A resistor labeled R is connected between the V_DD and the drain of the first MOSFET transistor, Q1.

3. **MOSFET Transistors (Q1 and Q2)**:
   - **Q1**: The first MOSFET transistor, Q1, has its drain connected to the resistor R, its gate connected to the drain of Q2, and its source connected to ground.
   - **Q2**: The second MOSFET transistor, Q2, has its drain connected to the output voltage node V_O, its gate connected to the drain of Q1, and its source connected to ground.

4. **Currents**:
   - **I_REF**: The current flowing through the resistor R is labeled I_REF.
   - **I_D1**: The current flowing through the drain of Q1 is labeled I_D1.
   - **I_O**: The current flowing through the drain of Q2 is labeled I_O.

5. **Voltages**:
   - **V_GS**: The voltage between the gate and source of Q1 is labeled V_GS.
   - **V_O**: The output voltage at the drain of Q2 is labeled V_O.

6. **Ground**: The source terminals of both Q1 and Q2 are connected to the ground.

7. **Arrows and Labels**: Blue arrows indicate the direction of current flow, and blue labels indicate the voltages and currents at various points in the circuit.

The circuit appears to be a current mirror configuration, where Q1 and Q2 are matched transistors used to replicate the current I_REF through Q1 to the output current I_O through Q2. The voltage V_GS is the gate-source voltage that controls the operation of the MOSFETs.
```

Figure 1: A MOSFET circuit rigged up as a current mirror used as a current source. Here, V<sup>O</sup> is chosen to ensure both transistors are in saturation (Courtesy of Sedra and Smith).

A MOSFET is always operating in the saturation regime when the drain is shorted to its gate, as shown in Figure 1. In this case, VDS = VGS > VGS −V<sup>t</sup> =

Printed on November 28, 2017 at 18 : 02: W.C. Chew and Z.H. Chen.

VOV implying saturation always. Then the drain current is given by

$$I\_{D1} = \frac{1}{2} k\_n' \left(\frac{W}{L}\right)\_1 (V\_{GS} - V\_{tn})^2 \tag{1.1}$$

ignoring the Early effect. The drain current is supplied by VDD through R as shown in Figure 1. The gate currents are zero, and hence,

$$I\_{D1} = I\_{\rm REF} = \frac{V\_{DD} - V\_{GS}}{R} \tag{1.2}$$

This is also a reference current, and hence named as IREF. Varying R changes this reference current.

Now if Q<sup>2</sup> is also made to operate in saturation by the appropriate choice of VO, then the current is

$$I\_O = I\_{D2} = \frac{1}{2} k\_n' \left(\frac{W}{L}\right)\_2 (V\_{GS} - V\_{tn})^2 \tag{1.3}$$

Hence, assuming that the transistors have the same threshold voltage Vtn, one gets

$$\frac{I\_O}{I\_{\rm REF}} = \frac{(W/L)\_2}{(W/L)\_1} \tag{1.4}$$

Thus by controlling the geometry of the two MOSFETs, one can control the ratio of the two drain currents.

Here is the image describtion:
```
The image depicts a simple current mirror circuit using two N-channel MOSFETs, labeled Q1 and Q2. Here is a detailed description of the circuit:

1. **Current Source (I_REF):** 
   - At the top left of the image, there is a current source labeled \( I_{REF} \). This current source is providing a reference current to the circuit.

2. **Transistor Q1:**
   - The MOSFET on the left is labeled Q1. The source of Q1 is connected to ground.
   - The gate and drain of Q1 are connected together, forming a diode-connected MOSFET configuration.
   - The drain of Q1 is also connected to the current source \( I_{REF} \).

3. **Transistor Q2:**
   - The MOSFET on the right is labeled Q2. The source of Q2 is also connected to ground.
   - The gate of Q2 is connected to the gate of Q1, ensuring that both transistors have the same gate-source voltage \( V_{GS} \).
   - The drain of Q2 is labeled as the output node, with the output current \( I_O \) flowing out of it. The output voltage at this node is labeled \( V_O \).

4. **Connections and Labels:**
   - The gates of Q1 and Q2 are connected together, and this common gate node is labeled with \( V_{GS} \) (the gate-source voltage).
   - The output current \( I_O \) is shown flowing downward from the drain of Q2.
   - The output voltage \( V_O \) is marked at the drain of Q2, with the positive terminal at the drain and the negative terminal at the source (ground).

This circuit is a basic current mirror, where the current through Q2 (output current \( I_O \)) is intended to mirror the reference current \( I_{REF} \) provided by the current source. The matching of the gate-source voltages \( V_{GS} \) of Q1 and Q2 ensures that the drain currents of Q1 and Q2 are equal, assuming the transistors are identical and operate in the saturation region.
```

Figure 2: A MOSFET circuit rigged up as a current mirror. Even when the transistors are not matched, such a circuit is called a current mirror (Courtesy of Sedra and Smith).

When I<sup>O</sup> = IREF, the second MOSFET mirrors the current of the first MOSFET. Even when the two drain currents are not equal, such designs are known as current mirrors. Figure 2 shows a simplified picture of the current mirror. The ratio dictated by (1.4) is also called the current transfer ratio.

### 1.1 Effect of V<sup>O</sup> on I<sup>O</sup>

The previous analysis assumes that when the MOS transistors are matched and are in the saturation mode, they have equal drain currents I<sup>D</sup> when their gate voltages VGS are the same. The reason being that the formula for the drain current in the saturation mode is

$$I\_D = \frac{1}{2} k\_n' \left(\frac{W}{L}\right) (V\_{GS} - V\_{tn})^2 \tag{1.5}$$

which depends only on VGS. But the above formula ignores Early effect that can cause the dependence of the drain current I<sup>D</sup> on VDS. This is shown in Figure 3.

Here is the image describtion:
```
The image is a graph depicting the relationship between the output current (I_O) and the output voltage (V_O) of a transistor. The graph is plotted with I_O on the vertical axis and V_O on the horizontal axis.

Key features of the graph include:

1. **Curve Shape**: The graph starts at the origin (0,0) and initially rises steeply, then gradually levels off, forming a curve that becomes almost horizontal as it moves to the right.

2. **Reference Current (I_REF)**: A horizontal dashed line is drawn from the y-axis at a point labeled I_REF, indicating a reference current level. This line intersects the curve at a specific point.

3. **Voltage Points**: 
   - V_GS - V_tn: A vertical dashed line is drawn from the x-axis at a point labeled V_GS - V_tn, which intersects the curve at the point where it starts to level off.
   - V_GS: Another vertical dashed line is drawn from the x-axis at a point labeled V_GS, which is further to the right of V_GS - V_tn.

4. **Overdrive Voltage (V_OV)**: The distance between V_GS - V_tn and V_GS on the x-axis is labeled as V_OV.

5. **Slope**: The slope of the curve in the region where it becomes almost horizontal is indicated as 1/r_o.

6. **Point of Interest**: There is a black dot on the curve at the intersection with the horizontal line I_REF, highlighting a specific operating point.

The graph illustrates the behavior of the transistor as it transitions from the linear region to the saturation region, where the current I_O becomes relatively constant despite increases in V_O. The slope 1/r_o represents the output conductance in the saturation region.
```

Figure 3: Output characteristics of a current source or a current mirror when the transistors are matched. Here, V<sup>O</sup> = VDS is the drain-source voltage (Courtesy of Sedra and Smith).

Notice that here in Figure 3, V<sup>O</sup> = VDS. In order for Q<sup>2</sup> to be saturated, it is needed that

$$V\_O \ge V\_{OV} = V\_{GS} - V\_{tn} \tag{1.6}$$

Ideally, I<sup>O</sup> does not increase with increasing V<sup>O</sup> but with the Early effect, I<sup>O</sup> increases slightly with V<sup>O</sup> as shown in Figure 3. This Early effect can be represented by the formula

$$I\_O = \frac{(W/L)\_2}{(W/L)\_1} I\_{\rm REF} \left( 1 + \frac{V\_O - V\_{GS}}{V\_{A2}} \right) \tag{1.7}$$

The above implies that I<sup>O</sup> matches IREF perfectly at V<sup>O</sup> = VGS if the two transistors are matched. The slope of the curve is such that

$$\frac{\Delta V\_O}{\Delta I\_O} = \frac{V\_{A2}}{I\_{\text{REF}}} \approx \frac{V\_{A2}}{I\_O} \tag{1.8}$$

assuming that (W/L)<sup>2</sup> (W/L)<sup>1</sup> ≈ 1.

## 2 MOS Current-Steering Circuits

The current mirror can be used to implement current-steering circuit as shown in Figure 4. In this circuit, ignoring Early effect, it is clear that

$$I\_2 = I\_{\rm REF} \frac{(W/L)\_2}{(W/L)\_1}, \qquad I\_3 = I\_{\rm REF} \frac{(W/L)\_3}{(W/L)\_1} \tag{2.1}$$

Furthermore, in Figure 4, for the two transistors Q<sup>2</sup> and Q<sup>3</sup> to be in saturation,

$$V\_{D2}, V\_{D3} \ge -V\_{SS} + V\_{GS1} - V\_{tn}, \text{ or } V\_{D2}, V\_{D3} \ge -V\_{SS} + V\_{OV1} \tag{2.2}$$

Notice that V<sup>D</sup> + VSS = VDS. The above just implies that that VDS of each transistor is larger than its overdrive voltage VOV to be in the saturation regime.

Here is the image describtion:
```
The image depicts a circuit diagram featuring multiple transistors and current sources. Here is a detailed description of the components and their connections:

1. **Transistors:**
   - **Q1** and **Q2**: These are N-channel MOSFETs (Metal-Oxide-Semiconductor Field-Effect Transistors). Q1 has its source connected to ground, and its gate is connected to the gate of Q2. The drain of Q1 is connected to a resistor R.
   - **Q3**: Another N-channel MOSFET with its source connected to a negative voltage supply (-V_SS) and its gate connected to the common gate of Q1 and Q2.
   - **Q4** and **Q5**: These are P-channel MOSFETs. Q4 has its source connected to a positive voltage supply (V_DD) and its gate connected to the gate of Q5. The drain of Q4 is connected to the drain of Q3. Q5 has its source connected to V_DD and its drain connected to a current source I5.

2. **Resistor:**
   - **R**: This resistor is connected between the drain of Q1 and a current source I_REF.

3. **Current Sources:**
   - **I_REF**: A current source connected to the top of resistor R, providing a reference current.
   - **I2**: A current source connected to the drain of Q2.
   - **I3**: A current source connected to the drain of Q3.
   - **I4**: A current source connected to the drain of Q4.
   - **I5**: A current source connected to the drain of Q5.

4. **Voltage Labels:**
   - **V_GS1**: The gate-source voltage of Q1.
   - **V_SG5**: The source-gate voltage of Q5.

5. **Connections:**
   - The gate of Q1 is connected to the gate of Q2.
   - The drain of Q1 is connected to the resistor R, which is connected to the current source I_REF.
   - The source of Q2 is connected to ground.
   - The drain of Q2 is connected to the current source I2.
   - The gate of Q3 is connected to the common gate of Q1 and Q2.
   - The drain of Q3 is connected to the drain of Q4.
   - The source of Q3 is connected to the negative voltage supply (-V_SS).
   - The gate of Q4 is connected to the gate of Q5.
   - The source of Q4 is connected to the positive voltage supply (V_DD).
   - The drain of Q4 is connected to the current source I4.
   - The source of Q5 is connected to the positive voltage supply (V_DD).
   - The drain of Q5 is connected to the current source I5.

The circuit appears to be a current mirror or a similar configuration used in analog circuits for current replication or biasing purposes.
```

Figure 4: A current-steering circuit using MOSFET (Courtesy of Sedra and Smith).

Some details of the current-steering circuit in Figure 4 are shown in Figure 5. Figure 5(a) shows the use of the current source to bias a common-drain amplifier (source follower), while Figure 5(b) shows its use to bias a commonsource amplifier.

Here is the image describtion:
```
The image consists of two circuit diagrams labeled (a) and (b), each depicting a different transistor configuration.

(a) The circuit on the left features two NPN bipolar junction transistors (BJTs) labeled Q6 and Q2. The collector of Q6 is connected to the positive supply voltage \( V_{DD} \), and its emitter is connected to the collector of Q2. The emitter of Q2 is connected to the negative supply voltage \( -V_{SS} \). The base of Q6 is connected to an input voltage \( v_{i6} \), and the base of Q2 is connected to an unspecified input (indicated by dashed lines). The output voltage \( v_{o6} \) is taken from the connection between the emitter of Q6 and the collector of Q2. A current \( I_2 \) is shown flowing downward through Q2.

(b) The circuit on the right features two N-channel MOSFETs labeled Q5 and Q7. The drain of Q5 is connected to the positive supply voltage \( V_{DD} \), and its source is connected to the drain of Q7. The source of Q7 is connected to the negative supply voltage \( -V_{SS} \). The gate of Q5 is connected to an unspecified input (indicated by dashed lines), and the gate of Q7 is connected to an input voltage \( v_{i7} \). The output voltage \( v_{o7} \) is taken from the connection between the source of Q5 and the drain of Q7. A current \( I_5 \) is shown flowing downward through Q7.

Both circuits illustrate common-emitter and common-source configurations for BJTs and MOSFETs, respectively, with the output taken from the connection between the two transistors in each configuration.
```

Figure 5: Applications of current-steering circuits. In (a), Q<sup>2</sup> is acting as a sink, while in (b), Q<sup>5</sup> is acting as a source (Courtesy of Sedra and Smith).

Figure 6 shows the biasing requirements of the steering circuit when it is operating as a current source in (a) and as a current sink in (b).

Here is the image describtion:
```
The image consists of two diagrams labeled (a) and (b), each depicting a current source with associated voltage levels and conditions.

Diagram (a):
- A current source is shown with an arrow pointing downward, indicating the direction of current flow (I).
- The current source is connected to a voltage supply labeled \( V_{DD} \) at the top.
- To the right of the current source, there is a horizontal line leading to an open circle, which represents the output voltage \( V_O \).
- The voltage \( V_{CSmin} \) is marked with a plus sign above the horizontal line and a minus sign below it, indicating a voltage drop.
- The condition \( V_O \leq V_{DD} - V_{CSmin} \) is written in blue text next to the horizontal line, specifying the maximum output voltage.

Diagram (b):
- Similar to diagram (a), a current source is shown with an arrow pointing downward, indicating the direction of current flow (I).
- The current source is connected to a voltage supply labeled \( -V_{SS} \) at the bottom.
- To the right of the current source, there is a horizontal line leading to an open circle, which represents the output voltage \( V_O \).
- The voltage \( V_{CSmin} \) is marked with a plus sign above the horizontal line and a minus sign below it, indicating a voltage drop.
- The condition \( V_O \geq -V_{SS} + V_{CSmin} \) is written in blue text next to the horizontal line, specifying the minimum output voltage.

Both diagrams illustrate the constraints on the output voltage \( V_O \) based on the supply voltages \( V_{DD} \) and \( -V_{SS} \) and the minimum voltage drop \( V_{CSmin} \) across the current source.
```

Figure 6: (a) A current source where the dotted line represents the outside world, and the circuit is pushing current into the outside world. (b) A current sink where the dotted line represent the outside, and circuit is drawing current from outside (Courtesy of Sedra and Smith).

#### 2.1 BJT Circuits

The BJT mirror has two important differences from that of the MOSFET. One is that the base currents of the transistors are not zero, and second, that even when the two transistors have the same VBE, the collector current would be different because the area of the emitter-base junction may be different. Hence, approximating the base current to be zero, or that β is very large,<sup>1</sup>

$$\frac{I\_O}{I\_{\rm REF}} = \frac{I\_{S2}}{I\_{S1}} = \frac{\text{Area of EBJ of } Q\_2}{\text{Area of EBJ of } Q\_1} \tag{2.3}$$

where ISi is the saturation current or the scale current of the i-th transistor.

Here is the image describtion:
```
The image depicts a simple current mirror circuit using two NPN bipolar junction transistors (BJTs), labeled Q1 and Q2. Here is a detailed description of the circuit:

1. **Transistors**:
   - **Q1**: The transistor on the left side of the circuit.
   - **Q2**: The transistor on the right side of the circuit.

2. **Current Source**:
   - **I_REF**: A reference current source is connected to the collector of Q1. This current source is depicted as a circle with an arrow pointing downward, indicating the direction of the current flow.

3. **Connections**:
   - The base of Q1 is connected to the base of Q2, forming a common node.
   - The emitter of Q1 is connected to the ground.
   - The emitter of Q2 is also connected to the ground.
   - The collector of Q1 is connected to the reference current source I_REF.
   - The collector of Q2 is connected to the output node, labeled as V_O.

4. **Voltage**:
   - **V_BE**: The base-emitter voltage is indicated between the base and emitter of both transistors, with the positive terminal at the base and the negative terminal at the emitter.

5. **Output Current**:
   - **I_O**: The output current flowing through the collector of Q2 is indicated by a blue arrow pointing downward.

6. **Output Voltage**:
   - **V_O**: The output voltage is labeled at the collector of Q2.

In summary, this circuit is a current mirror where the reference current I_REF sets the current through Q1, and ideally, the same current I_O flows through Q2, thus mirroring the reference current. The output voltage V_O is taken from the collector of Q2.
```

Figure 7: A basic BJT current mirror circuit (Courtesy of Sedra and Smith).

To see the effect of finite β on the current mirror, we can assume that the two BJT's are matched. Referring to Figure 8, one can see that

$$I\_{\rm REF} = I\_C + 2I\_C/\beta = I\_C \left(1 + \frac{2}{\beta}\right) \tag{2.4}$$

For a pair of matched transisfor, I<sup>O</sup> = I<sup>C</sup> , and the current transfer ratio becomes

$$\frac{I\_O}{I\_{\rm REF}} = \frac{I\_C}{I\_{\rm REF}} = \frac{1}{1 + \frac{2}{\beta}}\tag{2.5}$$

For imperfectly matched transistors such that IS<sup>2</sup> = mIS1, one can show that

$$\frac{I\_O}{I\_{\rm REF}} = \frac{m}{1 + \frac{m+1}{\beta}}\tag{2.6}$$

<sup>1</sup>Recall that the collector current I<sup>C</sup> = I<sup>S</sup> exp(VBE/V<sup>T</sup> ).

Even if the finite β effect is not there, the Early effect will result in different I<sup>C</sup> 's for the two transistors unless V<sup>O</sup> = VBE. In order to account for this, one can write

$$I\_O = I\_{\rm REF} \frac{m}{1 + \frac{m+1}{\beta}} \left( 1 + \frac{V\_O - V\_{BE}}{V\_{A2}} \right) \tag{2.7}$$

In the above, VA<sup>2</sup> is derived from the definition of the Early effect such that

$$r\_{o2} = V\_{A2}/I\_O \tag{2.8}$$

Here is the image describtion:
```
The image depicts a transistor-based current mirror circuit. Here is a detailed description of the components and their connections:

1. **Current Source (I_REF)**: At the top left of the image, there is a current source labeled \( I_{REF} \). This current source is providing a reference current to the circuit.

2. **Transistors (Q1 and Q2)**: There are two NPN transistors labeled \( Q_1 \) and \( Q_2 \). The collector of \( Q_1 \) is connected to the current source \( I_{REF} \), and the collector of \( Q_2 \) is connected to the output node \( V_O \).

3. **Connections and Currents**:
   - The emitter of \( Q_1 \) is connected to ground through a resistor, and the emitter of \( Q_2 \) is also connected to ground through a similar resistor.
   - The base of \( Q_1 \) is connected to the base of \( Q_2 \), and this common base connection is also connected to the collector of \( Q_1 \).
   - The current flowing through the collector of \( Q_1 \) is labeled \( I_C \).
   - The current flowing through the collector of \( Q_2 \) is labeled \( I_O \), which is equal to \( I_C \).

4. **Current Distribution**:
   - The current \( I_C \) splits into two parts at the base of \( Q_1 \): \( I_C / \beta \) flows into the base of \( Q_1 \), and \( I_C (1 + 1/\beta) \) flows through the emitter of \( Q_1 \) to ground.
   - Similarly, the current \( I_C \) splits at the base of \( Q_2 \): \( I_C / \beta \) flows into the base of \( Q_2 \), and \( I_C (1 + 1/\beta) \) flows through the emitter of \( Q_2 \) to ground.
   - The current through the base of \( Q_2 \) is also \( I_C / \beta \), and the current through the collector of \( Q_2 \) is \( I_O = I_C \).

5. **Output Voltage (V_O)**: The output voltage \( V_O \) is taken from the collector of \( Q_2 \).

6. **Current Relationships**:
   - The current through the collector of \( Q_1 \) is \( I_C \).
   - The current through the collector of \( Q_2 \) is \( I_O = I_C \).
   - The current through the emitter of each transistor is \( I_C (1 + 1/\beta) \).

This circuit is a classic current mirror, which is used to copy the current from one active device (transistor \( Q_1 \)) to another (transistor \( Q_2 \)), ensuring that \( I_O \) is equal to \( I_C \).
```

Figure 8: Finite β effect on the current mirror. Because β is not infinite, IREF is not equal to I<sup>O</sup> (Courtesy of Sedra and Smith).

#### 2.2 A Simple Current Source

A simple BJT current source can be implemented as shown in Figure 9. Assume a matched transistor case, then

$$I\_O = \frac{I\_{\rm REF}}{1 + 2/\beta} \left( 1 + \frac{V\_O - V\_{BE}}{V\_A} \right) \tag{2.9}$$

The output resistance of this approximate current source is ∆VO/∆IO, which is

$$R\_o \approx V\_A / I\_{\rm REF} \approx V\_A / I\_O \tag{2.10}$$

This could be a large value, making this a good approximation of a current source.

Here is the image describtion:
```
The image depicts a simple current mirror circuit using two NPN bipolar junction transistors (BJTs), labeled Q1 and Q2. Here is a detailed description of the components and their connections:

1. **Power Supply (V_CC)**: The circuit is powered by a voltage source labeled V_CC, which is connected to the top of the circuit.

2. **Resistor (R)**: A resistor labeled R is connected between the V_CC and the collector of transistor Q1. This resistor is used to set the reference current (I_REF).

3. **Transistor Q1**: The transistor Q1 has its collector connected to the resistor R, its base connected to the base of transistor Q2, and its emitter connected to ground. The base-emitter voltage of Q1 is labeled as V_BE.

4. **Transistor Q2**: The transistor Q2 has its base connected to the base of Q1, its collector connected to the output node (V_O), and its emitter connected to ground.

5. **Current Labels**: The reference current flowing through Q1 is labeled as I_REF, and the output current flowing through Q2 is labeled as I_O.

6. **Output Voltage (V_O)**: The output voltage is taken from the collector of Q2 and is labeled as V_O.

The circuit works as a current mirror, where the current I_REF through Q1 is mirrored to the current I_O through Q2. The transistors Q1 and Q2 are configured such that they share the same base-emitter voltage (V_BE), ensuring that the current through Q2 (I_O) is proportional to the current through Q1 (I_REF).
```

Figure 9: A simple BJT current mirror used as a current source (Courtesy of Sedra and Smith).

#### 2.3 Current Steering

Figure 10 shows the use of the current mirrors to generate current sources and sinks of different amplitudes.

Here is the image describtion:
```
The image depicts a transistor-based circuit diagram, likely representing a current mirror or a differential amplifier configuration. Here is a detailed description of the components and their connections:

1. **Transistors:**
   - There are nine transistors labeled Q1 to Q9.
   - Q1 and Q2 are connected in a differential pair configuration.
   - Q3 and Q4 are connected to the collectors of Q1 and Q2, respectively.
   - Q5 is connected to the collector of Q3.
   - Q6 is connected to the collector of Q5.
   - Q7 is connected to the collector of Q4.
   - Q8 and Q9 are connected in parallel to the collector of Q7.

2. **Resistor:**
   - There is a resistor labeled R connected between the emitter of Q1 and the base of Q2.

3. **Currents:**
   - The currents are labeled as I_REF, I1, I2, I3, and I4.
   - I_REF flows through the resistor R.
   - I1 flows through the collector of Q3.
   - I2 flows through the collector of Q4.
   - I3 flows through the collector of Q6.
   - I4 flows through the collectors of Q8 and Q9.

4. **Power Supply:**
   - V_CC is the positive power supply connected to the collectors of Q3 and Q5.
   - -V_EE is the negative power supply connected to the emitters of Q4 and Q7.

5. **Connections:**
   - The base of Q1 is connected to the collector of Q2.
   - The base of Q2 is connected to the emitter of Q1.
   - The base of Q3 is connected to the collector of Q1.
   - The base of Q4 is connected to the collector of Q2.
   - The base of Q5 is connected to the collector of Q3.
   - The base of Q6 is connected to the collector of Q5.
   - The base of Q7 is connected to the collector of Q4.
   - The bases of Q8 and Q9 are connected to the collector of Q7.

This circuit appears to be a complex current mirror or a differential amplifier with multiple stages, designed to provide stable current sources and amplification.
```

Figure 10: Ways to generate constant current sources and sinks of various magnitude by current steering (Courtesy of Sedra and Smith).

#### 2.4 Base-Current Compensation

Figure 11 shows a circuit where the base current can be further reduced so that IREF is as close to I<sup>C</sup> as possible. Assume a matched transistor case, then

$$\frac{I\_O}{I\_{\rm REF}} = \frac{1}{1 + 2/(\beta(\beta + 1))} \approx 1/(1 + 2/\beta^2) \tag{2.11}$$

Therefore, the currents, I<sup>O</sup> and IREF, are greatly equalized in this design.

Here is the image describtion:
```
The image depicts a transistor circuit diagram, specifically a current mirror circuit. Here is a detailed description of the components and their connections:

1. **Current Source (I_REF)**: At the top left of the diagram, there is a current source labeled \( I_{REF} \). This current source is providing a reference current to the circuit.

2. **Transistors (Q1, Q2, Q3)**: There are three NPN bipolar junction transistors (BJTs) labeled Q1, Q2, and Q3.
   - **Q1**: The emitter of Q1 is connected to ground. The base of Q1 is connected to the base of Q2 and the collector of Q3.
   - **Q2**: The emitter of Q2 is also connected to ground. The collector of Q2 is connected to the output current \( I_O \), which is equal to \( I_C \).
   - **Q3**: The emitter of Q3 is connected to the node labeled \( x \). The base of Q3 is connected to the collector of Q1. The collector of Q3 is connected to the current source \( I_{REF} \).

3. **Currents**:
   - The current \( I_{REF} \) flows into the collector of Q3.
   - The collector current of Q1 is labeled \( I_C \).
   - The base current of Q1 is \( \frac{I_C}{\beta} \), where \( \beta \) is the current gain of the transistor.
   - The current flowing through the base of Q2 is also \( \frac{I_C}{\beta} \).
   - The current flowing through the collector of Q2 is \( I_O = I_C \).
   - The current flowing through the base of Q3 is \( \frac{2I_C}{\beta(\beta+1)} \).
   - The current flowing through the collector of Q3 is \( \frac{2I_C}{\beta} \).

4. **Connections**:
   - The node \( x \) is a common point where the emitter of Q3, the collector of Q1, and the base of Q3 are connected.
   - The base of Q1 and Q2 are connected together and also connected to the collector of Q3.
   - The emitters of Q1 and Q2 are both connected to ground.

The circuit is designed to mirror the reference current \( I_{REF} \) through Q1 and Q2, ensuring that the output current \( I_O \) is equal to the collector current \( I_C \) of Q1. This type of circuit is commonly used in analog integrated circuits to provide stable current sources.
```

Figure 11: A current mirror with base-current compensation. By adding an extra transistor, the base current can be made very small if β is large (Courtesy of Sedra and Smith).

### 3 Small-Signal Operation of Current Mirrors

Using the hybrid-π model, the current mirror in Figure 12(a) can be replaced by that of Figure 12(b). Note that for transistor Q1, the gate is connected to the drain in this small-signal model. But since the current source behaves exactly like a resistor of 1/gm1, the final small-signal model can be replaced by Figure 12(c).

First, one assumes that ro<sup>1</sup> 1/gm1, then i<sup>i</sup> = vgsgm1. Assuming that the the small-signal for Q<sup>2</sup> output is short-circuited or that Q<sup>2</sup> is biased by a DC voltage source, then, i<sup>o</sup> = gm2vgs. Then the short-circuit current gain is

$$A\_{is} = \frac{i\_o}{i\_i} \approx g\_{m2}/g\_{m1} \tag{3.1}$$

Here,

$$g\_{m1,2} = \mu\_n C\_{ox} (W/L)\_{1,2} V\_{OV,1,2} \tag{3.2}$$

Since VOV = VGS −Vt, assuming that the two transistors have the same threshold voltage Vt, then the two overdrive voltages are the same. Using (3.2) in (3.1), the short-circuit current gain is

$$A\_{is} = \frac{(W/L)\_2}{(W/L)\_1} \tag{3.3}$$

Therefore, one can have current amplification by changing the geometries of the two transistor. Moreover, this current amplification is the same as that for the DC current transfer ratio case as shown in (1.4) which is for large signals. Therefore, with clever engineering, the strong linearity of this current amplifier can be achieved all the way from small signals to large DC signals.

Here is the image describtion:
```
The image consists of four diagrams labeled (a), (b), and (c), which illustrate the small-signal equivalent circuit analysis of a two-transistor amplifier.

(a) The first diagram shows the original circuit with two transistors, Q1 and Q2, connected in a configuration. The current sources ID1 + ii and ID2 + io are shown entering the transistors Q1 and Q2, respectively. The voltage VGS + vgs is applied between the gate and source of Q1, and the source of Q1 is connected to the gate of Q2. The source of Q2 is grounded.

(b) The second diagram shows the small-signal equivalent circuit of the transistors. The left part of the diagram represents the small-signal model of Q1, with the current source ii, the output resistance ro1, and the transconductance gm1vgs. The right part of the diagram represents the small-signal model of Q2, with the transconductance gm2vgs and the output resistance ro2. The output current io is shown flowing out of the circuit.

(c) The third diagram is similar to (b) but includes additional details. The input resistance Rin is calculated as the parallel combination of ro1 and 1/gm1, which simplifies to 1/gm1. The output resistance Ro is shown as ro2, and the output current io is given by gm2vgs. The output short-circuit condition is indicated, showing that Ro = ro2.

Overall, the image provides a detailed analysis of the small-signal equivalent circuit of a two-transistor amplifier, including the calculation of input and output resistances and the behavior of the output current.
```

Figure 12: Small-signal model for the MOS current mirror as an amplifier (Courtesy of Sedra and Smith).