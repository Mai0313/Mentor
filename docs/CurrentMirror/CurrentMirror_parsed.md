# ECE 255, Current Sources, Mirrors etc

28 November 2017

In this lecture, we will follow Section 8.2 of Sedra and Smith. It will be on IC biasing, current sources, current mirrors, and current-steering circuits. In this method, a reference current is generated by a circuit, and then replicated at other circuits by current mirror or current steering.

### 1 The Basic MOSFET Current Source

Here is the image describtion:
```
The image depicts a MOSFET current mirror circuit. Here is a detailed description of the components and their connections:

1. **Power Supply (V_DD)**: The circuit is powered by a DC voltage source labeled \( V_{DD} \) at the top of the diagram.

2. **Resistor (R)**: A resistor \( R \) is connected between the power supply \( V_{DD} \) and the drain of the first MOSFET transistor \( Q_1 \).

3. **MOSFET Transistors (Q_1 and Q_2)**: There are two n-channel MOSFET transistors labeled \( Q_1 \) and \( Q_2 \). The source terminals of both transistors are connected to the ground.

4. **Current Flow**:
   - \( I_{REF} \): The reference current \( I_{REF} \) flows through the resistor \( R \) and the drain of \( Q_1 \).
   - \( I_{D1} \): The drain current \( I_{D1} \) flows through \( Q_1 \).
   - \( I_O \): The output current \( I_O \) flows through the drain of \( Q_2 \).

5. **Gate Connections**: The gate of \( Q_1 \) is connected to its own drain, creating a diode-connected MOSFET. The gate of \( Q_2 \) is connected to the gate of \( Q_1 \), ensuring that both transistors have the same gate-source voltage \( V_{GS} \).

6. **Output Voltage (V_O)**: The output voltage \( V_O \) is taken from the drain of \( Q_2 \).

7. **Ground**: The source terminals of both \( Q_1 \) and \( Q_2 \) are connected to the ground.

8. **Voltage Labels**:
   - \( V_{GS} \): The gate-source voltage is labeled between the gate and source of \( Q_1 \) and \( Q_2 \).

The circuit operates as a current mirror, where the current \( I_{REF} \) through \( Q_1 \) sets the gate-source voltage \( V_{GS} \). This same \( V_{GS} \) is applied to \( Q_2 \), causing it to mirror the current \( I_{REF} \) as \( I_O \), assuming both transistors are identical and operate in the saturation region.
```

Figure 1: A MOSFET circuit rigged up as a current mirror used as a current source. Here, V<sup>O</sup> is chosen to ensure both transistors are in saturation (Courtesy of Sedra and Smith).

A MOSFET is always operating in the saturation regime when the drain is shorted to its gate, as shown in Figure 1. In this case, VDS = VGS > VGS −V<sup>t</sup> =

Printed on November 28, 2017 at 18 : 02: W.C. Chew and Z.H. Chen.

VOV implying saturation always. Then the drain current is given by

$$I\_{D1} = \frac{1}{2} k\_n' \left(\frac{W}{L}\right)\_1 (V\_{GS} - V\_{tn})^2 \tag{1.1}$$

ignoring the Early effect. The drain current is supplied by VDD through R as shown in Figure 1. The gate currents are zero, and hence,

$$I\_{D1} = I\_{\rm REF} = \frac{V\_{DD} - V\_{GS}}{R} \tag{1.2}$$

This is also a reference current, and hence named as IREF. Varying R changes this reference current.

Now if Q<sup>2</sup> is also made to operate in saturation by the appropriate choice of VO, then the current is

$$I\_O = I\_{D2} = \frac{1}{2} k\_n' \left(\frac{W}{L}\right)\_2 (V\_{GS} - V\_{tn})^2 \tag{1.3}$$

Hence, assuming that the transistors have the same threshold voltage Vtn, one gets

$$\frac{I\_O}{I\_{\rm REF}} = \frac{(W/L)\_2}{(W/L)\_1} \tag{1.4}$$

Thus by controlling the geometry of the two MOSFETs, one can control the ratio of the two drain currents.

Here is the image describtion:
```
The image depicts a simple current mirror circuit using two NMOS transistors, labeled Q1 and Q2. Here is a detailed description of the circuit:

1. **Current Source (I_REF)**: 
   - At the top left of the circuit, there is a current source labeled \( I_{REF} \). This current source provides a reference current that sets the operating point for the current mirror.

2. **Transistor Q1**:
   - The transistor on the left is labeled Q1. It is an NMOS transistor with its drain connected to the current source \( I_{REF} \).
   - The gate of Q1 is connected to its drain, which means Q1 is operating in saturation mode and acts as a diode-connected transistor.
   - The source of Q1 is connected to ground.

3. **Transistor Q2**:
   - The transistor on the right is labeled Q2. It is also an NMOS transistor.
   - The gate of Q2 is connected to the gate of Q1, ensuring that both transistors have the same gate-source voltage \( V_{GS} \).
   - The source of Q2 is connected to ground.
   - The drain of Q2 is connected to the output node, where the output current \( I_O \) flows.

4. **Output Node (V_O)**:
   - The output node is labeled \( V_O \) and is located at the drain of Q2.
   - The output current \( I_O \) flows from the drain of Q2 to the output node.

5. **Voltage Labels**:
   - The voltage between the gate and source of both transistors is labeled \( V_{GS} \).
   - The output voltage at the drain of Q2 is labeled \( V_O \).

6. **Current Flow**:
   - The reference current \( I_{REF} \) flows through Q1, setting up a gate-source voltage \( V_{GS} \) that is mirrored to Q2.
   - Assuming both transistors are identical and operate in the same region, the current \( I_O \) through Q2 will mirror the reference current \( I_{REF} \).

In summary, this circuit is a basic current mirror where the current through Q2 (output current \( I_O \)) is designed to mirror the reference current \( I_{REF} \) set by the current source. The gate-source voltage \( V_{GS} \) is the same for both transistors, ensuring that the current through Q2 is proportional to the current through Q1.
```

Figure 2: A MOSFET circuit rigged up as a current mirror. Even when the transistors are not matched, such a circuit is called a current mirror (Courtesy of Sedra and Smith).

When I<sup>O</sup> = IREF, the second MOSFET mirrors the current of the first MOSFET. Even when the two drain currents are not equal, such designs are known as current mirrors. Figure 2 shows a simplified picture of the current mirror. The ratio dictated by (1.4) is also called the current transfer ratio.

### 1.1 Effect of V<sup>O</sup> on I<sup>O</sup>

The previous analysis assumes that when the MOS transistors are matched and are in the saturation mode, they have equal drain currents I<sup>D</sup> when their gate voltages VGS are the same. The reason being that the formula for the drain current in the saturation mode is

$$I\_D = \frac{1}{2} k\_n' \left(\frac{W}{L}\right) (V\_{GS} - V\_{tn})^2 \tag{1.5}$$

which depends only on VGS. But the above formula ignores Early effect that can cause the dependence of the drain current I<sup>D</sup> on VDS. This is shown in Figure 3.

Here is the image describtion:
```
The image is a graph that depicts the relationship between the output current (I_O) and the output voltage (V_O) of a MOSFET transistor. The graph is divided into two regions: the linear (ohmic) region and the saturation region.

1. **Axes**:
   - The vertical axis represents the output current (I_O).
   - The horizontal axis represents the output voltage (V_O).

2. **Curve**:
   - The curve starts from the origin (0,0) and initially rises steeply, indicating a rapid increase in current with a small increase in voltage. This part of the curve represents the linear (ohmic) region.
   - As the curve progresses, it starts to flatten out, indicating that the current becomes relatively constant despite further increases in voltage. This part of the curve represents the saturation region.

3. **Key Points and Labels**:
   - **I_REF**: A horizontal dashed line indicating a reference current level in the saturation region.
   - **V_GS - V_tn**: A vertical dashed line indicating the threshold voltage (V_tn) subtracted from the gate-source voltage (V_GS).
   - **V_GS**: A vertical dashed line indicating the gate-source voltage.
   - **V_OV**: The overdrive voltage, which is the difference between V_GS and V_tn.
   - **Slope = 1/r_o**: In the saturation region, the slope of the curve is labeled as 1/r_o, where r_o is the output resistance of the MOSFET.

4. **Regions**:
   - **Linear (Ohmic) Region**: The initial steep part of the curve where the MOSFET operates like a variable resistor.
   - **Saturation Region**: The flatter part of the curve where the MOSFET operates as a constant current source.

The graph illustrates how the MOSFET transitions from the linear region to the saturation region as the output voltage increases, and it highlights the key parameters that influence this behavior.
```

Figure 3: Output characteristics of a current source or a current mirror when the transistors are matched. Here, V<sup>O</sup> = VDS is the drain-source voltage (Courtesy of Sedra and Smith).

Notice that here in Figure 3, V<sup>O</sup> = VDS. In order for Q<sup>2</sup> to be saturated, it is needed that

$$V\_O \ge V\_{OV} = V\_{GS} - V\_{tn} \tag{1.6}$$

Ideally, I<sup>O</sup> does not increase with increasing V<sup>O</sup> but with the Early effect, I<sup>O</sup> increases slightly with V<sup>O</sup> as shown in Figure 3. This Early effect can be represented by the formula

$$I\_O = \frac{(W/L)\_2}{(W/L)\_1} I\_{\rm REF} \left( 1 + \frac{V\_O - V\_{GS}}{V\_{A2}} \right) \tag{1.7}$$

The above implies that I<sup>O</sup> matches IREF perfectly at V<sup>O</sup> = VGS if the two transistors are matched. The slope of the curve is such that

$$\frac{\Delta V\_O}{\Delta I\_O} = \frac{V\_{A2}}{I\_{\text{REF}}} \approx \frac{V\_{A2}}{I\_O} \tag{1.8}$$

assuming that (W/L)<sup>2</sup> (W/L)<sup>1</sup> ≈ 1.

## 2 MOS Current-Steering Circuits

The current mirror can be used to implement current-steering circuit as shown in Figure 4. In this circuit, ignoring Early effect, it is clear that

$$I\_2 = I\_{\rm REF} \frac{(W/L)\_2}{(W/L)\_1}, \qquad I\_3 = I\_{\rm REF} \frac{(W/L)\_3}{(W/L)\_1} \tag{2.1}$$

Furthermore, in Figure 4, for the two transistors Q<sup>2</sup> and Q<sup>3</sup> to be in saturation,

$$V\_{D2}, V\_{D3} \ge -V\_{SS} + V\_{GS1} - V\_{tn}, \text{ or } V\_{D2}, V\_{D3} \ge -V\_{SS} + V\_{OV1} \tag{2.2}$$

Notice that V<sup>D</sup> + VSS = VDS. The above just implies that that VDS of each transistor is larger than its overdrive voltage VOV to be in the saturation regime.

Here is the image describtion:
```
The image depicts a current mirror circuit, which is a common configuration in analog integrated circuits used to replicate a current from one active device to another. Here is a detailed description of the circuit:

1. **Components and Configuration:**
   - The circuit consists of five MOSFET transistors labeled Q1, Q2, Q3, Q4, and Q5.
   - There is a resistor labeled R connected to the drain of Q1.
   - The circuit is powered by two voltage supplies: V_DD (positive supply) and V_SS (negative supply).

2. **Current Flow:**
   - A reference current, I_REF, flows through the resistor R and the transistor Q1.
   - The gate of Q1 is connected to the gate of Q2, forming a current mirror. The source of Q1 is connected to the negative supply V_SS.
   - The current I2 flows through Q2, which is a mirrored current of I_REF.

3. **Cascoding:**
   - The transistor Q3 is connected in series with Q2, with its gate connected to a bias voltage.
   - The current I3 flows through Q3, which is the same as I2 due to the series connection.

4. **Upper Current Mirror:**
   - The transistors Q4 and Q5 form another current mirror.
   - The gate of Q4 is connected to the gate of Q5, and the source of Q4 is connected to the drain of Q3.
   - The current I4 flows through Q4, and the current I5 flows through Q5, which is a mirrored current of I4.

5. **Voltage Levels:**
   - The voltage across the gate and source of Q1 is labeled V_GS1.
   - The voltage across the source and gate of Q5 is labeled V_SG5.

6. **Current Relationships:**
   - The reference current I_REF sets the current through Q1.
   - The current through Q2 (I2) is mirrored from I_REF.
   - The current through Q3 (I3) is the same as I2.
   - The current through Q4 (I4) is mirrored from I3.
   - The current through Q5 (I5) is mirrored from I4.

In summary, the circuit is designed to replicate the reference current I_REF through multiple stages using current mirrors, ensuring that the currents I2, I3, I4, and I5 are proportional to I_REF. This configuration is often used in analog circuits to provide stable and precise current sources.
```

Figure 4: A current-steering circuit using MOSFET (Courtesy of Sedra and Smith).

Some details of the current-steering circuit in Figure 4 are shown in Figure 5. Figure 5(a) shows the use of the current source to bias a common-drain amplifier (source follower), while Figure 5(b) shows its use to bias a commonsource amplifier.

Here is the image describtion:
```
The image shows two different transistor circuits, labeled (a) and (b). Each circuit consists of two transistors connected in a specific configuration.

### Circuit (a):
1. **Transistors**: The circuit includes two N-channel MOSFETs, labeled Q6 and Q2.
2. **Connections**:
   - The drain of Q6 is connected to the positive supply voltage \( V_{DD} \).
   - The source of Q6 is connected to the drain of Q2.
   - The source of Q2 is connected to the negative supply voltage \( -V_{SS} \).
   - The gate of Q6 is connected to an input voltage \( v_{i6} \).
   - The gate of Q2 is connected to an unspecified input (indicated by dashed lines).
3. **Output**: The output voltage \( v_{o6} \) is taken from the connection between the source of Q6 and the drain of Q2.
4. **Current**: The current \( I_2 \) flows from the drain of Q6 through Q2 to \( -V_{SS} \).

### Circuit (b):
1. **Transistors**: The circuit includes two P-channel MOSFETs, labeled Q5 and Q7.
2. **Connections**:
   - The drain of Q5 is connected to the positive supply voltage \( V_{DD} \).
   - The source of Q5 is connected to the drain of Q7.
   - The source of Q7 is connected to the negative supply voltage \( -V_{SS} \).
   - The gate of Q5 is connected to an unspecified input (indicated by dashed lines).
   - The gate of Q7 is connected to an input voltage \( v_{i7} \).
3. **Output**: The output voltage \( v_{o7} \) is taken from the connection between the source of Q5 and the drain of Q7.
4. **Current**: The current \( I_5 \) flows from the drain of Q5 through Q7 to \( -V_{SS} \).

### Summary:
- Both circuits are examples of MOSFET configurations.
- Circuit (a) uses N-channel MOSFETs, while circuit (b) uses P-channel MOSFETs.
- The output voltages \( v_{o6} \) and \( v_{o7} \) are taken from the middle points of the respective transistor pairs.
- The currents \( I_2 \) and \( I_5 \) flow through the transistors from the positive supply to the negative supply.
```

Figure 5: Applications of current-steering circuits. In (a), Q<sup>2</sup> is acting as a sink, while in (b), Q<sup>5</sup> is acting as a source (Courtesy of Sedra and Smith).

Figure 6 shows the biasing requirements of the steering circuit when it is operating as a current source in (a) and as a current sink in (b).

Here is the image describtion:
```
The image consists of two circuit diagrams labeled (a) and (b). Both diagrams feature a current source and voltage references, but they are configured differently.

### Diagram (a):
- **Current Source**: There is a current source symbolized by a circle with an arrow pointing downwards, indicating the direction of current flow (I).
- **Voltage Reference**: The top of the current source is connected to a voltage source labeled \( V_{DD} \), which is a positive voltage supply.
- **Output Node**: The output node \( V_O \) is located to the right of the current source.
- **Voltage Drop**: There is a voltage drop across the current source labeled \( V_{CSmin} \).
- **Voltage Condition**: The output voltage \( V_O \) is constrained by the condition \( V_O \leq V_{DD} - V_{CSmin} \).

### Diagram (b):
- **Current Source**: Similar to diagram (a), there is a current source with a circle and a downward-pointing arrow indicating the current flow (I).
- **Voltage Reference**: The bottom of the current source is connected to a voltage source labeled \( -V_{SS} \), which is a negative voltage supply.
- **Output Node**: The output node \( V_O \) is located to the right of the current source.
- **Voltage Drop**: There is a voltage drop across the current source labeled \( V_{CSmin} \).
- **Voltage Condition**: The output voltage \( V_O \) is constrained by the condition \( V_O \geq -V_{SS} + V_{CSmin} \).

### Common Elements:
- Both diagrams feature a current source with a specified minimum voltage drop across it, denoted as \( V_{CSmin} \).
- The output voltage \( V_O \) in both diagrams is subject to constraints involving the voltage supply and the minimum voltage drop across the current source.

### Differences:
- Diagram (a) uses a positive voltage supply \( V_{DD} \) and the output voltage \( V_O \) must be less than or equal to \( V_{DD} - V_{CSmin} \).
- Diagram (b) uses a negative voltage supply \( -V_{SS} \) and the output voltage \( V_O \) must be greater than or equal to \( -V_{SS} + V_{CSmin} \).

These diagrams likely represent the operating conditions for a current source in different configurations, ensuring that the output voltage remains within specified limits based on the supply voltage and the minimum voltage drop across the current source.
```

Figure 6: (a) A current source where the dotted line represents the outside world, and the circuit is pushing current into the outside world. (b) A current sink where the dotted line represent the outside, and circuit is drawing current from outside (Courtesy of Sedra and Smith).

#### 2.1 BJT Circuits

The BJT mirror has two important differences from that of the MOSFET. One is that the base currents of the transistors are not zero, and second, that even when the two transistors have the same VBE, the collector current would be different because the area of the emitter-base junction may be different. Hence, approximating the base current to be zero, or that β is very large,<sup>1</sup>

$$\frac{I\_O}{I\_{\rm REF}} = \frac{I\_{S2}}{I\_{S1}} = \frac{\text{Area of EBJ of } Q\_2}{\text{Area of EBJ of } Q\_1} \tag{2.3}$$

where ISi is the saturation current or the scale current of the i-th transistor.

Here is the image describtion:
```
The image depicts a simple current mirror circuit using bipolar junction transistors (BJTs). Here is a detailed description of the circuit:

1. **Transistors**: The circuit consists of two NPN transistors, labeled \( Q_1 \) and \( Q_2 \).
   - The emitter of \( Q_1 \) is connected to ground.
   - The emitter of \( Q_2 \) is also connected to ground.

2. **Current Source**: There is a current source labeled \( I_{REF} \) connected to the collector of \( Q_1 \). This current source provides a reference current for the circuit.

3. **Base Connection**: The bases of both transistors \( Q_1 \) and \( Q_2 \) are connected together and share a common node. This node is also connected to the collector of \( Q_1 \).

4. **Output**: The collector of \( Q_2 \) is connected to the output node labeled \( V_O \). The output current flowing through the collector of \( Q_2 \) is labeled \( I_O \).

5. **Voltage**: The voltage between the base and emitter of the transistors is labeled \( V_{BE} \).

**Operation**:
- The current source \( I_{REF} \) sets a reference current through \( Q_1 \).
- Since the bases of \( Q_1 \) and \( Q_2 \) are connected together, they have the same base-emitter voltage \( V_{BE} \).
- Assuming both transistors are identical and operate in the active region, the current through \( Q_2 \) (output current \( I_O \)) will mirror the reference current \( I_{REF} \).

This configuration is commonly used in analog circuits to create a stable current source or to replicate currents in different parts of a circuit.
```

Figure 7: A basic BJT current mirror circuit (Courtesy of Sedra and Smith).

To see the effect of finite β on the current mirror, we can assume that the two BJT's are matched. Referring to Figure 8, one can see that

$$I\_{\rm REF} = I\_C + 2I\_C/\beta = I\_C \left(1 + \frac{2}{\beta}\right) \tag{2.4}$$

For a pair of matched transisfor, I<sup>O</sup> = I<sup>C</sup> , and the current transfer ratio becomes

$$\frac{I\_O}{I\_{\rm REF}} = \frac{I\_C}{I\_{\rm REF}} = \frac{1}{1 + \frac{2}{\beta}}\tag{2.5}$$

For imperfectly matched transistors such that IS<sup>2</sup> = mIS1, one can show that

$$\frac{I\_O}{I\_{\rm REF}} = \frac{m}{1 + \frac{m+1}{\beta}}\tag{2.6}$$

<sup>1</sup>Recall that the collector current I<sup>C</sup> = I<sup>S</sup> exp(VBE/V<sup>T</sup> ).

Even if the finite β effect is not there, the Early effect will result in different I<sup>C</sup> 's for the two transistors unless V<sup>O</sup> = VBE. In order to account for this, one can write

$$I\_O = I\_{\rm REF} \frac{m}{1 + \frac{m+1}{\beta}} \left( 1 + \frac{V\_O - V\_{BE}}{V\_{A2}} \right) \tag{2.7}$$

In the above, VA<sup>2</sup> is derived from the definition of the Early effect such that

$$r\_{o2} = V\_{A2}/I\_O \tag{2.8}$$

Here is the image describtion:
```
The image depicts a current mirror circuit using bipolar junction transistors (BJTs). Here is a detailed description of the circuit:

1. **Current Source (I_REF)**: At the top left of the circuit, there is a current source labeled \( I_{REF} \). This current source provides a reference current for the circuit.

2. **Transistors (Q1 and Q2)**: The circuit consists of two NPN BJTs, labeled \( Q_1 \) and \( Q_2 \). The collector of \( Q_1 \) is connected to the current source \( I_{REF} \), and the collector of \( Q_2 \) is connected to the output node \( V_O \).

3. **Collector Currents**: The collector current of \( Q_1 \) is labeled \( I_C \). The collector current of \( Q_2 \) is labeled \( I_O \), which is equal to \( I_C \).

4. **Base-Emitter Junctions**: The bases of \( Q_1 \) and \( Q_2 \) are connected together, and their emitters are connected to ground through resistors. This configuration ensures that both transistors have the same base-emitter voltage \( V_{BE} \).

5. **Emitter Currents**: The emitter current of \( Q_1 \) is \( I_C \left(1 + \frac{1}{\beta}\right) \), where \( \beta \) is the current gain of the transistor. Similarly, the emitter current of \( Q_2 \) is \( I_C \left(1 + \frac{1}{\beta}\right) \).

6. **Base Currents**: The base current of \( Q_1 \) is \( \frac{I_C}{\beta} \), and the base current of \( Q_2 \) is also \( \frac{I_C}{\beta} \).

7. **Current Flow**: The current \( I_{REF} \) splits into the collector current \( I_C \) of \( Q_1 \) and the base current of \( Q_2 \). The base current of \( Q_2 \) is \( \frac{I_C}{\beta} \), and the remaining current \( 2 \frac{I_C}{\beta} \) flows through the base of \( Q_1 \).

8. **Output Current**: The output current \( I_O \) is equal to the collector current \( I_C \) of \( Q_2 \), which mirrors the collector current \( I_C \) of \( Q_1 \).

In summary, this circuit is a current mirror where the output current \( I_O \) is designed to be equal to the reference current \( I_{REF} \), assuming ideal conditions and matched transistors. The circuit ensures that the current through \( Q_2 \) mirrors the current through \( Q_1 \), making it useful for biasing and current regulation in analog circuits.
```

Figure 8: Finite β effect on the current mirror. Because β is not infinite, IREF is not equal to I<sup>O</sup> (Courtesy of Sedra and Smith).

#### 2.2 A Simple Current Source

A simple BJT current source can be implemented as shown in Figure 9. Assume a matched transistor case, then

$$I\_O = \frac{I\_{\rm REF}}{1 + 2/\beta} \left( 1 + \frac{V\_O - V\_{BE}}{V\_A} \right) \tag{2.9}$$

The output resistance of this approximate current source is ∆VO/∆IO, which is

$$R\_o \approx V\_A / I\_{\rm REF} \approx V\_A / I\_O \tag{2.10}$$

This could be a large value, making this a good approximation of a current source.

Here is the image describtion:
```
The image depicts a simple current mirror circuit using bipolar junction transistors (BJTs). Here is a detailed description of the circuit:

1. **Transistors**: The circuit consists of two NPN transistors, labeled Q1 and Q2. The emitters of both transistors are connected to the ground.

2. **Power Supply**: The circuit is powered by a voltage source labeled \( V_{CC} \), which is connected to the top of the circuit.

3. **Resistor**: There is a resistor labeled \( R \) connected between \( V_{CC} \) and the collector of transistor Q1.

4. **Reference Current**: The current flowing through the resistor \( R \) and the collector of Q1 is labeled \( I_{REF} \). This current sets the reference current for the current mirror.

5. **Base Connection**: The bases of both transistors Q1 and Q2 are connected together, ensuring that both transistors have the same base-emitter voltage \( V_{BE} \).

6. **Collector Connection**: The collector of Q2 is connected to the output node labeled \( V_O \). The current flowing through the collector of Q2 is labeled \( I_O \).

7. **Operation**: The circuit operates as a current mirror. The reference current \( I_{REF} \) flowing through Q1 sets the base-emitter voltage \( V_{BE} \). Since Q1 and Q2 have their bases connected together and their emitters are at the same potential (ground), Q2 will have the same \( V_{BE} \) as Q1. Assuming the transistors are identical and operate in the active region, the current \( I_O \) through Q2 will mirror the reference current \( I_{REF} \).

In summary, this circuit is designed to replicate the reference current \( I_{REF} \) through Q1 in the output current \( I_O \) through Q2, thus functioning as a current mirror.
```

Figure 9: A simple BJT current mirror used as a current source (Courtesy of Sedra and Smith).

#### 2.3 Current Steering

Figure 10 shows the use of the current mirrors to generate current sources and sinks of different amplitudes.

Here is the image describtion:
```
The image depicts a transistor-based circuit, likely a part of an analog integrated circuit such as a differential amplifier or a current mirror. Here is a detailed description of the components and their connections:

1. **Transistors**: The circuit consists of nine bipolar junction transistors (BJTs) labeled Q1 to Q9.
   - Q1 and Q2 form a differential pair.
   - Q3 and Q4 are connected to the collectors of Q1 and Q2, respectively.
   - Q5 and Q6 are connected in a configuration that suggests a current mirror.
   - Q7, Q8, and Q9 are connected in a configuration that suggests another current mirror or a part of a differential amplifier.

2. **Resistor**: There is a resistor labeled R connected to the emitter of Q1 and the base of Q2.

3. **Currents**: Several currents are labeled in the circuit:
   - \( I_{REF} \) flows through the resistor R and into the emitter of Q1.
   - \( I_1 \) flows from the collector of Q3.
   - \( I_2 \) flows from the collector of Q4.
   - \( I_3 \) flows from the collector of Q6.
   - \( I_4 \) flows from the collector of Q9.

4. **Power Supply**: The circuit is powered by two voltage sources:
   - \( V_{CC} \) is the positive supply voltage connected to the collectors of Q3 and Q5.
   - \( -V_{EE} \) is the negative supply voltage connected to the emitters of Q4 and Q7.

5. **Connections**:
   - The base of Q1 is connected to the collector of Q2.
   - The base of Q2 is connected to the emitter of Q1 through the resistor R.
   - The collector of Q1 is connected to the base of Q3.
   - The collector of Q2 is connected to the base of Q4.
   - The emitters of Q3 and Q4 are connected to the bases of Q5 and Q7, respectively.
   - The collector of Q5 is connected to the base of Q6.
   - The emitters of Q5 and Q6 are connected together.
   - The collectors of Q8 and Q9 are connected together and to the base of Q7.
   - The emitters of Q8 and Q9 are connected to the negative supply voltage \( -V_{EE} \).

This circuit appears to be a complex analog circuit, possibly a part of an operational amplifier or a current mirror with differential input stages. The exact function would depend on the specific application and additional context.
```

Figure 10: Ways to generate constant current sources and sinks of various magnitude by current steering (Courtesy of Sedra and Smith).

#### 2.4 Base-Current Compensation

Figure 11 shows a circuit where the base current can be further reduced so that IREF is as close to I<sup>C</sup> as possible. Assume a matched transistor case, then

$$\frac{I\_O}{I\_{\rm REF}} = \frac{1}{1 + 2/(\beta(\beta + 1))} \approx 1/(1 + 2/\beta^2) \tag{2.11}$$

Therefore, the currents, I<sup>O</sup> and IREF, are greatly equalized in this design.

Here is the image describtion:
```
The image depicts a transistor-based current mirror circuit, which is a common configuration in analog integrated circuits for copying current from one active device to another. Here is a detailed description of the circuit:

1. **Transistors**: The circuit consists of three NPN bipolar junction transistors (BJTs) labeled Q1, Q2, and Q3.
   - Q1 and Q2 form the core of the current mirror.
   - Q3 is used to improve the performance of the current mirror by providing additional current gain.

2. **Current Source**: There is a current source labeled \( I_{REF} \) at the top left of the circuit. This current source provides a reference current that sets the operating point of the current mirror.

3. **Connections**:
   - The collector of Q1 is connected to the node labeled 'x', which is also connected to the emitter of Q3.
   - The base of Q1 is connected to the base of Q2, ensuring that both transistors have the same base-emitter voltage.
   - The emitters of Q1 and Q2 are connected together and then to ground through a resistor (not shown in the image).
   - The collector of Q2 is connected to the output node, where the output current \( I_O \) is taken.
   - The collector of Q3 is connected to the power supply (positive voltage rail).

4. **Currents**:
   - The reference current \( I_{REF} \) flows into the node 'x'.
   - The current \( I_C \) flows through the collector of Q1.
   - The current through Q3 is split into two parts: \( \frac{2I_C}{\beta(\beta+1)} \) and \( \frac{2I_C}{\beta} \), where \( \beta \) is the current gain (or beta) of the transistors.
   - The current through Q2 is \( I_C \), which is the same as the current through Q1 due to the current mirror configuration.

5. **Output Current**: The output current \( I_O \) is equal to the collector current \( I_C \) of Q2, which mirrors the collector current of Q1.

6. **Current Gain**: The use of Q3 improves the accuracy of the current mirror by providing additional current gain, which helps to ensure that the current through Q2 closely matches the current through Q1.

In summary, this circuit is a current mirror with an additional transistor (Q3) to enhance performance. The reference current \( I_{REF} \) sets the current \( I_C \) through Q1, which is then mirrored to Q2, providing an output current \( I_O \) that is equal to \( I_C \). The additional transistor Q3 helps to improve the accuracy of the current mirroring by providing extra current gain.
```

Figure 11: A current mirror with base-current compensation. By adding an extra transistor, the base current can be made very small if β is large (Courtesy of Sedra and Smith).

### 3 Small-Signal Operation of Current Mirrors

Using the hybrid-π model, the current mirror in Figure 12(a) can be replaced by that of Figure 12(b). Note that for transistor Q1, the gate is connected to the drain in this small-signal model. But since the current source behaves exactly like a resistor of 1/gm1, the final small-signal model can be replaced by Figure 12(c).

First, one assumes that ro<sup>1</sup> 1/gm1, then i<sup>i</sup> = vgsgm1. Assuming that the the small-signal for Q<sup>2</sup> output is short-circuited or that Q<sup>2</sup> is biased by a DC voltage source, then, i<sup>o</sup> = gm2vgs. Then the short-circuit current gain is

$$A\_{is} = \frac{i\_o}{i\_i} \approx g\_{m2}/g\_{m1} \tag{3.1}$$

Here,

$$g\_{m1,2} = \mu\_n C\_{ox} (W/L)\_{1,2} V\_{OV,1,2} \tag{3.2}$$

Since VOV = VGS −Vt, assuming that the two transistors have the same threshold voltage Vt, then the two overdrive voltages are the same. Using (3.2) in (3.1), the short-circuit current gain is

$$A\_{is} = \frac{(W/L)\_2}{(W/L)\_1} \tag{3.3}$$

Therefore, one can have current amplification by changing the geometries of the two transistor. Moreover, this current amplification is the same as that for the DC current transfer ratio case as shown in (1.4) which is for large signals. Therefore, with clever engineering, the strong linearity of this current amplifier can be achieved all the way from small signals to large DC signals.

Here is the image describtion:
```
The image consists of a series of diagrams that illustrate the small-signal analysis of a MOSFET differential amplifier. Here is a detailed description of each part of the image:

1. **Diagram (a):**
   - This is the circuit diagram of a differential amplifier using two MOSFETs, Q1 and Q2.
   - The current source \( I_D1 + i_i \) is connected to the drain of Q1.
   - The source terminals of Q1 and Q2 are connected together and to ground through a voltage source \( V_{GS} + v_{gs} \).
   - The drain of Q2 is connected to the current source \( I_D2 + i_o \).
   - The output current \( i_o \) is shown flowing out of the drain of Q2.

2. **Diagram (b):**
   - This is the small-signal equivalent circuit of the differential amplifier.
   - On the left side, the small-signal model of Q1 is shown with the current source \( i_i \) connected to the gate.
   - The drain of Q1 is connected to a resistor \( r_{o1} \) and a current source \( g_{m1} v_{gs} \), which represents the transconductance of Q1.
   - The source of Q1 is connected to the small-signal voltage \( v_{gs} \).
   - On the right side, the small-signal model of Q2 is shown with a current source \( g_{m2} v_{gs} \) connected to the drain.
   - The drain of Q2 is also connected to a resistor \( r_{o2} \), and the output current \( i_o \) is shown flowing out of the drain.

3. **Diagram (c):**
   - This diagram further simplifies the small-signal model.
   - On the left side, the input resistance \( R_{in} \) is calculated as the parallel combination of \( r_{o1} \) and \( \frac{1}{g_{m1}} \), which simplifies to \( \frac{1}{g_{m1}} \).
   - The current source \( i_i \) is connected to this input resistance.
   - On the right side, the output resistance \( R_o \) is shown as \( r_{o2} \).
   - The output current \( i_o \) is shown as \( g_{m2} v_{gs} \), and the output is short-circuited to ground.

Overall, the image provides a step-by-step breakdown of the small-signal analysis of a MOSFET differential amplifier, showing the equivalent circuits and the calculation of input and output resistances.
```

Figure 12: Small-signal model for the MOS current mirror as an amplifier (Courtesy of Sedra and Smith).